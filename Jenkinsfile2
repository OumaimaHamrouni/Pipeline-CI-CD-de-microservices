pipeline {
    agent any
    stages {
    stage('Apply Kubernetes File') {
        steps {
          withKubeCredentials(kubectlCredentials: [[caCertificate: '', clusterName: 'kubernetes', contextName: '', credentialsId: '	kubejenkins', namespace: 'default', serverUrl: 'https://172.31.25.107:6443']]) 

         {
               sh 'curl -LO "https://storage.googleapis.com/kubernetes-release/release/v1.20.5/bin/linux/amd64/kubectl"'
               sh 'chmod u+x ./kubectl'
               sh './kubectl apply -f mongo.yml'
                sh './kubectl apply -f product.yml'
               echo 'service ok'
         }
            }
  }
}
}